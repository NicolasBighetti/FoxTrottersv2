<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width">
  <title></title>

  <link rel="manifest" href="manifest.json">

  <!-- un-comment this code to enable service worker
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js')
        .then(() => console.log('service worker installed'))
        .catch(err => console.log('Error', err));
    }
  </script>-->

  <link href="lib/ionic/css/ionic.css" rel="stylesheet">
  <link href="lib/ng-swippy/ngswippy.css" rel="stylesheet">

  <link href="css/style.css" rel="stylesheet">

  <!-- IF using Sass (run gulp sass first), then uncomment below and remove the CSS includes above
  <link href="css/ionic.app.css" rel="stylesheet">
  -->

  <script src="lib/angular/angular.js"></script>
  <script src="lib/angular-animate/angular-animate.js"></script>
  <script src="lib/angular-touch/angular-touch.js"></script>
  <script src="lib/angular-route/angular-route.js"></script>
  <script src="lib/angular-sanitize/angular-sanitize.js"></script>
  <script src="lib/angular-ui-router/release/angular-ui-router.js"></script>
  <script src="lib/angular-ui/ui-bootstrap-2.5.0.js"></script>

  <!-- ionic/angularjs js -->
  <!--<script src="lib/ionic/js/ionic.bundle.js"></script>-->
  <script src="lib/ionic/js/ionic.min.js"></script>
  <script src="lib/ionic/js/ionic-angular.js"></script>

  <!-- cordova script (this will be a 404 during development) -->
  <script src="lib/ngCordova/dist/ng-cordova.js"></script>
  <script src="cordova.js"></script>


  <!-- BluetoothSerial script -->
  <!-- your app's js -->
  <script src="js/app.js"></script>

  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAGMBQQC143VTbPWjLWEBJfB3LSzD0LnPw"></script>
  <!--<script src="lib/ngmap/build/scripts/ng-map.min.js"></script>-->
   <script src="node_modules/ngmap/build/scripts/ng-map.js"></script>
   <script src="lib/ng-swippy/ng-swippy.js"></script>
   <script src="lib/ng-file-upload/ng-file-upload.js"></script>

   <!-- wrapper -->

  <script src="js/cordovaWrapper/RichNotificationWrapper.js"></script>


  <!-- controllers -->
  <script src="js/controllers/GMapController.js"></script>
  <script src="js/controllers/PhotoController.js"></script>
  <script src="js/controllers/PlantinderController.js"></script>
  <script src="js/controllers/BLEController.js"> </script>
  <script src="js/controllers/CreationController.js"></script>


  <!-- services -->
  <script src="js/services/PhotoService.js"></script>
  <script src="js/services/MarkerService.js"></script>
  <script src="js/services/SmartWatchService.js"></script>
  <script src="js/services/RESTService.js"></script>
  <script src="js/services/GeolocationService.js"></script>
  <script src="js/services/PictureUploadService.js"></script>

  <!-- filters -->
  <script src="js/filters/MarkerFilter.js"></script>

  <!-- Route -->
  <script src="js/RouteConfiguration.js"></script>
</head>
<body ng-app="foxapp">

<ion-pane>
  <ion-view>
    <ion-content>
      <div id="map" ng-controller="GMapController">
        <div class="search">
          <div class="rowelement">
            <svg style="width:24px;height:24px" viewBox="0 0 24 24">
              <path fill="#000000" d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" />
            </svg>
          </div>
          <div class="rowelement">
            <input class="plantSearch" type="text" ng-model="plantname">
          </div>
          <div class="rowelement">
            <div class="filter-bar search">
              <a class="active rowelement" href="#" ng-click="changeFilter('')">
                <svg style="width:24px;height:24px" viewBox="0 0 24 24">
                  <path fill="#000000" d="M3.05,13H1V11H3.05C3.5,6.83 6.83,3.5 11,3.05V1H13V3.05C17.17,3.5 20.5,6.83 20.95,11H23V13H20.95C20.5,17.17 17.17,20.5 13,20.95V23H11V20.95C6.83,20.5 3.5,17.17 3.05,13M12,5A7,7 0 0,0 5,12A7,7 0 0,0 12,19A7,7 0 0,0 19,12A7,7 0 0,0 12,5Z" />
                </svg>
              </a>
              <a href="#" class="rowelement" ng-click="changeFilter('plant')">
                <img src="pictures/icons/plant.png"/>
              </a>
              <a href="#" class="rowelement" ng-click="changeFilter('water')">
                <img src="pictures/icons/water.png"/>
              </a>
              <a href="#" class="rowelement" ng-click="changeFilter('viewpoint')">
                <img src="pictures/icons/viewpoint.png"/>
              </a>
              <div class='clear'></div>
            </div>
          </div>
          <div class='clear'></div>
        </div>
        <div class="control">
          <div class="container">
            <div class="icon-bar">
              <a class="active" href="#">
                <svg style="width:100%;height:100%" viewBox="0 0 24 24">
                  <path fill="#000000" d="M4,5V7H21V5M4,11H21V9H4M4,19H21V17H4M4,15H21V13H4V15Z" />
                </svg>
              </a>
              <a href="#" ng-controller="PhotoController" ng-click="recognizePlant(sendPicture(URL.plantinder, takePicture(options)))">
                <svg style="width:100%;height:100%" align="center" viewBox="0 0 24 24">
                  <path fill="#000000" d="M9,3L7.17,5H4A2,2 0 0,0 2,7V19A2,2 0 0,0 4,21H20A2,2 0 0,0 22,19V7A2,2 0 0,0 20,5H16.83L15,3M12,18A5,5 0 0,1 7,13A5,5 0 0,1 12,8A5,5 0 0,1 17,13A5,5 0 0,1 12,18M12,17L13.25,14.25L16,13L13.25,11.75L12,9L10.75,11.75L8,13L10.75,14.25" />
                </svg>
              </a>
              <a href="#" ng-click="tinderise()">
                <svg style="width:100%;height:100%" viewBox="0 0 24 24">
                  <path fill="#000000" d="M3,13A9,9 0 0,0 12,22C12,17 7.97,13 3,13M12,5.5A2.5,2.5 0 0,1 14.5,8A2.5,2.5 0 0,1 12,10.5A2.5,2.5 0 0,1 9.5,8A2.5,2.5 0 0,1 12,5.5M5.6,10.25A2.5,2.5 0 0,0 8.1,12.75C8.63,12.75 9.12,12.58 9.5,12.31C9.5,12.37 9.5,12.43 9.5,12.5A2.5,2.5 0 0,0 12,15A2.5,2.5 0 0,0 14.5,12.5C14.5,12.43 14.5,12.37 14.5,12.31C14.88,12.58 15.37,12.75 15.9,12.75C17.28,12.75 18.4,11.63 18.4,10.25C18.4,9.25 17.81,8.4 16.97,8C17.81,7.6 18.4,6.74 18.4,5.75C18.4,4.37 17.28,3.25 15.9,3.25C15.37,3.25 14.88,3.41 14.5,3.69C14.5,3.63 14.5,3.56 14.5,3.5A2.5,2.5 0 0,0 12,1A2.5,2.5 0 0,0 9.5,3.5C9.5,3.56 9.5,3.63 9.5,3.69C9.12,3.41 8.63,3.25 8.1,3.25A2.5,2.5 0 0,0 5.6,5.75C5.6,6.74 6.19,7.6 7.03,8C6.19,8.4 5.6,9.25 5.6,10.25M12,22A9,9 0 0,0 21,13C16,13 12,17 12,22Z" />
                </svg>
              </a>
              <a href="#" ng-click="addPOI()">
                <svg style="width:100%;height:100%" viewBox="0 0 24 24">
                  <path fill="#000000" d="M9,11.5A2.5,2.5 0 0,0 11.5,9A2.5,2.5 0 0,0 9,6.5A2.5,2.5 0 0,0 6.5,9A2.5,2.5 0 0,0 9,11.5M9,2C12.86,2 16,5.13 16,9C16,14.25 9,22 9,22C9,22 2,14.25 2,9A7,7 0 0,1 9,2M15,17H18V14H20V17H23V19H20V22H18V19H15V17Z" />
                </svg>
              </a>
            </div>
          </div>
        </div>
        <div id="fox-map" map-lazy-load="https://maps.google.com/maps/api/js" map-lazy-load-params={{googleMapsUrl}} >
          <ng-map disable-default-u-i="true"
                  center="[{{position.lat}}, {{position.lng}}]"
                  map-type-id="terrain"
                  styles="[{featureType:'administrative',elementType:'all',stylers:[{visibility:'on'}]},{featureType:'administrative',elementType:'labels.text.fill',stylers:[{color:'#9d935e'}]},{featureType:'administrative',elementType:'labels.text.stroke',stylers:[{color:'#3f3b28'}]},{featureType:'landscape',elementType:'geometry.fill',stylers:[{color:'#5a5335'}]},{featureType:'landscape.man_made',elementType:'geometry.fill',stylers:[{color:'#4d4329'}]},{featureType:'landscape.man_made',elementType:'geometry.stroke',stylers:[{visibility:'off'}]},{featureType:'landscape.natural.terrain',elementType:'geometry.fill',stylers:[{color:'#6e6950'}]},{featureType:'poi',elementType:'geometry.fill',stylers:[{color:'#372f14'}]},{featureType:'poi',elementType:'labels',stylers:[{visibility:'off'}]},{featureType:'poi.park',elementType:'geometry.fill',stylers:[{color:'#372f14'}]},{featureType:'road',elementType:'all',stylers:[{saturation:-100},{lightness:45},{color:'#959358'}]},{featureType:'road',elementType:'labels.text',stylers:[{visibility:'off'}]},{featureType:'road.highway',elementType:'all',stylers:[{visibility:'simplified'}]},{featureType:'road.arterial',elementType:'labels.icon',stylers:[{visibility:'off'}]},{featureType:'transit',elementType:'all',stylers:[{visibility:'off'}]},{featureType:'water',elementType:'geometry.fill',stylers:[{color:'#344144'}]}]"
                  zoom="15" >
            <shape name="polyline"
                   path={{GPSTrace}}
                   geodesic="true"
                   stroke-color="#FF0000"
                   stroke-opacity="1.0"
                   stroke-weight="2">
            </shape>
            <marker ng-repeat="Object in foxMarkers | filterByCriteria:plantname:category"
                    id="{{Object._id}}"
                    on-click="showDetail(Object)"
                    position=[{{Object.coords.latitude}},{{Object.coords.longitude}}]
                    icon="{
                            url:'pictures/icons/{{Object.typep}}.png',
                            scaledSize:[20,20]
                            }"
            >
            </marker>
            <marker position="[{{position.lat}},{{position.lng}}]"
                    icon="{
                            url:'pictures/icons/me.png',
                            scaledSize:[20,20]
                            }"
            >
            </marker>
            <info-window id="foo-iw">
              <div ng-non-bindable="">
                <img ng-src="{{poi.icon}}" />
                Name: {{poi.name}}<br/>
                Description: {{poi.desc}}<br/>
                Danger: {{poi.dangerzone}}<br/>
                Visitors: {{poi.people}}<br/>
                Created by: {{poi.user.displayName}}<br/>
                <img ng-src="{{poi.image}}" /><br/>
                <div id="plant-info" ng-hide="poi.plant == null">
                  <h3>Plant informations:</h3>
                  Common name: {{poi.plant.commonName}}<br/>
                  <img ng-src="{{poi.plant.image[0]}}" />
                  Latin name: {{poi.plant.latinName}}<br/>
                  Family: {{poi.plant.family}}<br/>
                  Genre: {{poi.plant.genre}}<br/>
                  <div ng-repeat="useElem in poi.plant.uses">
                    <img ng-src="{{ useElem.theme.icon }}" width="5%"  />
                    <h3 ng-bind="useElem.theme.desc"></h3>
                    <p>{{useElem.desc}}</p>
                  </div>
                  <small>
                    <em class="text-muted">
                      Posted on
                      <span ng-bind="poi.plant.created | date:'mediumDate'"></span>
                      by
                      <span ng-if="poi.plant.user"
                            ng-bind="poi.plant.user.displayName"></span>
                      <span ng-if="!poi.plant.user">Deleted User</span>
                    </em>
                  </small>
                </div>
                <button class="btn btn-success" ng-controller="BLEController" ng-click="notificate()">Suivre</button>
                <form ng-controller="GMapController">
                  <i title="Up Votes" ng-click="vote({{poi}},1)" class="fa fa-arrow-circle-up fa-2x" ng-class="{true:'up', false:''}[vote=='up']"></i>
                  {{poi.score}}
                  <i title="Down Votes" ng-click="vote({{poi}},0)" class="fa fa-arrow-circle-down fa-2x"  ng-class="{true:'down', false:''}[vote=='down']"></i>
                </form>
              </div>
            </info-window>
          </ng-map>
        </div>

        <div ng-hide="tinderswitch" class="momo" modal="showModal" close="cancel()" ng-controller="PlantinderController">
          <div class="modal-header">
            <h4>Modal Dialog</h4>
          </div>
          <div class="modal-body">
            <div name="plantinder"  >
              <ng-swippy class="plantinder"collection='itemsCollection' width='80%' height='80%' item-click='zoomPicture' data='showinfo'collection-empty='swipeend' swipe-left='swipeLeft'  swipe-right='swipeRight' cards-number='2' label-ok='Je connais cette plantes!' label-negative='Je ne connais pas cette plante'></ng-swippy>
            </div>
          </div>
          <div class="modal-footer">
            <button class="btn btn-success" ng-click="ok()">Okay</button>
            <button class="btn" ng-click="cancel()">Cancel</button>
          </div>
        </div>

        <div ng-hide="creationPOI" class="creationMomo" modal="creationPOI" close="cancel()" ng-controller="CreationController">
          <div class="modal-header">
            <h4>Créer un point</h4>
          </div>
          <div class="modal-body">
            <form name="vm.form.poiForm" class="form-horizontal" ng-submit="save()" novalidate>
              <fieldset>
                <div class="form-group" show-errors>

                  <label class="control-label" for="name">Name</label>
                  <input name="name" type="text" ng-model="poi.name" id="name" class="form-control" placeholder="Enter name" required>

                  <label class="control-label" for="desc">Description</label>
                  <input name="desc" type="text" ng-model="poi.desc" id="desc" class="form-control" placeholder="Enter description" required>
                  <div class="photo">
                    <button href="#" ng-controller="PhotoController" ng-click="setURI(takePicture(options))">
                      Ajouter une photo
                    </button>
                    <img src="{{$scope.poi.image}}" />
                  </div>
                  <h4>Type</h4>
                  <select ng-model="poi.typep">
                    <option value="plant">Plant</option>
                    <option value="viewpoint">Viewpoint</option>
                    <option value="water">Water</option>
                  </select>
                </div>
                <div class="form-group">
                  <button class="btn btn-default" ng-click="createPOI()">Create</button>
                  <button class="btn btn-default" ng-click="cancel()"> Cancel </button>
                </div>
              </fieldset>
            </form>
          </div>
          <div class="modal-footer">
          </div>
        </div>

      </div>

    </ion-content>
  </ion-view>

</ion-pane>
</body>
</html>
